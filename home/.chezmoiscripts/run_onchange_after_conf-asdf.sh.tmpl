{{- if (eq .chezmoi.os "linux" "darwin") -}}
#!/usr/bin/env bash
set -Eeuo pipefail

plugin_add() {
  # don't exit with exit code 2
  asdf plugin-add "$1" "${2:-}" || [ $? -eq 2 ]
}

if [ ! -e "$HOME/.asdf" ]; then
  git clone https://github.com/asdf-vm/asdf.git "$HOME/.asdf" --branch v0.10.2
fi

. "$HOME/.asdf/asdf.sh"

while read -r plugin _; do
  plugin_add "$plugin"
done <"$HOME/.tool-versions"

asdf direnv setup --shell zsh --version 2.32.2
asdf install
{{- end -}}
{{/* vim: set filetype=sh: */}}
